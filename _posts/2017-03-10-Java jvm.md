---
layout: post
title:  "Java JVM相关知识点"
date:   2017-03-10 10:11:03 +0800
categories: Java JVM
tag: Java
---

### 基本概念

JVM是Java Virtual Machine Java虚拟机的缩写，JVM是一种计算机设备的规范，是一个虚构出来的计算机，通过实际计算机上仿真模拟各种计算机功能来实现。

引入Java语言虚拟机后，Java语言在不同平台上运行不需要重新编译。Java语言使用Java虚拟机屏蔽与具体平台相关信息，使Java语言编译只需要生成在Java虚拟机上运行的目标代码（字节码），就可在多种平台上不加修改的运行。

![JVM概述图](/images/posts/20191216/JVM.jpeg)<br>

### 运行过程

Java源文件，通过编译器产生对应的.class文件，也就是字节码文件，字节码文件通过Java虚拟机解释器，编译成特定机器上的机器码。

1. Java源文件->编译器->字节码文件
2. 字节码文件->JVM->机器码

每个平台的解释器不同，但是实现的虚拟机是相同的，这是Java跨平台的原因。

但一个程序开始运行，这时虚拟机就开始实例化了，多个程序启动就会存在多个虚拟机实例。

程序退出或者关闭，虚拟机实例消亡，多个虚拟机实例之间数据不共享。

![JVM图1](/images/posts/20191216/01.png)<br>

### 线程

线程是指程序执行过程中的操作系统能够运行调度的最小单元。包含在进程之中，是进程的实际运作单位。

JVM 允许一个应用并发执行多个线程。当线程本地存储、缓冲区分配、同步对象、栈、程序计数器等准备好后，

就会创建一个操作系统原生线程。Java线程结束，原生线程回收，操作系统负责调度所有线程，把他们分配到任何可用的CPU上。

当原生线程初始化完毕，就会调用Java的run()方法，当线程结束时，会释放原生线程和Java线程的所有资源。

Hotspot Jvm 后台运行的系统线程主要有以下几种：

名称 | 介绍
---- | ----
虚拟机线程（VM thread） | 这个线程等待JVM到达安全点操作出现。这些操作必须再独立线程内执行，因为当堆修改无法进行时，线程都需要JVM位于安全点。操作有stop-the-world垃圾回收、线程栈dump、线程暂停、线程偏向锁解除。
周期性任务线程 | 负责定时器事件（中断），用来调度周期性操作的执行。
GC线程 | 支持JVM中不同的垃圾回收活动。
编译器线程 | 这些线程再运行时将字节码动态编译成本地平台相关机器码。
信号分发线程 | 这个线程接受发送到JVM的信号并调用适当的JVM方法处理。
